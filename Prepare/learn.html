<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Prepare/learn">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Learn | IBM Client Engineering</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ibm-client-engineering.github.io/solution-mq-gitops/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://ibm-client-engineering.github.io/solution-mq-gitops/img/logo.svg"><meta data-rh="true" property="og:url" content="https://ibm-client-engineering.github.io/solution-mq-gitops/Prepare/learn"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="ibm client engineering, open solutions library,  filenet, eks, aws, cp4ba, filenet on aws eks"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Learn | IBM Client Engineering"><meta data-rh="true" name="description" content="- Spin up a test MQ Cluster (on aws EKS) and deploy the MQ Container using an older image"><meta data-rh="true" property="og:description" content="- Spin up a test MQ Cluster (on aws EKS) and deploy the MQ Container using an older image"><link data-rh="true" rel="icon" href="/solution-mq-gitops/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ibm-client-engineering.github.io/solution-mq-gitops/Prepare/learn"><link data-rh="true" rel="alternate" href="https://ibm-client-engineering.github.io/solution-mq-gitops/Prepare/learn" hreflang="en"><link data-rh="true" rel="alternate" href="https://ibm-client-engineering.github.io/solution-mq-gitops/Prepare/learn" hreflang="x-default"><link rel="stylesheet" href="/solution-mq-gitops/assets/css/styles.1116ef7f.css">
<link rel="preload" href="/solution-mq-gitops/assets/js/runtime~main.285e8d6b.js" as="script">
<link rel="preload" href="/solution-mq-gitops/assets/js/main.6d7487b9.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solution-mq-gitops/"><div class="navbar__logo"><img src="/solution-mq-gitops/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA" height="200" width="200"><img src="/solution-mq-gitops/img/logo-dark.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="200" width="200"></div><b class="navbar__title text--truncate">| Middleware Automation</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/${vars.org}/${vars.project}" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solution-mq-gitops/">Flight Path</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-gitops/category/innovate">Innovate</a><button aria-label="Toggle the collapsible sidebar category &#x27;Innovate&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solution-mq-gitops/category/prepare">Prepare</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prepare&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solution-mq-gitops/Prepare/learn">Learn</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-mq-gitops/Prepare/organize">Organize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solution-mq-gitops/Prepare/stage">Stage</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-gitops/category/co-create">Co-Create</a><button aria-label="Toggle the collapsible sidebar category &#x27;Co-Create&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solution-mq-gitops/category/transition">Transition</a><button aria-label="Toggle the collapsible sidebar category &#x27;Transition&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/solution-mq-gitops/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solution-mq-gitops/category/prepare"><span itemprop="name">Prepare</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Learn</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Solution Strategy</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- Spin up a test MQ Cluster (on aws EKS) and deploy the MQ Container using an older image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Build an ArgoCD Pipeline for this repo to that cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Automate rollng upgrades of MQ to a newer image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Automate the creation of queues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Automate the creation of test data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><a href="#environment">ENVIRONMENT</a></p></li><li><p><a href="#prerequisites">PRE-REQUISITES</a></p><ul><li><a href="#login-into-your-aws-eks-cluster">LOGIN INTO YOUR AWS EKS CLUSTER</a></li></ul></li><li><p><a href="#overview">OVERVIEW</a></p><ul><li><a href="#tools">TOOLS</a></li><li><a href="#get-the-aws-cli">GET THE AWS CLI</a></li><li><a href="#get-kubectl">GET KUBECTL</a></li><li><a href="#get-the-argocd-cli">GET THE ARGOCD CLI</a></li><li><a href="#argocd">ARGOCD</a><ul><li><a href="#create-a-hosted-zone-in-route-53">CREATE A HOSTED ZONE IN ROUTE 53</a></li><li><a href="#request-a-certificate-for-the-hosted-zone">REQUEST A CERTIFICATE FOR THE HOSTED ZONE</a></li><li><a href="#install-argocd-into-your-cluster">INSTALL ARGOCD INTO YOUR CLUSTER</a></li><li><a href="#create-the-argocy-service-patch-template">CREATE THE ARGOCY SERVICE PATCH TEMPLATE</a></li><li><a href="#note-the-arn-is-copied-from-the-create-certificate-output">NOTE THE ARN IS COPIED FROM THE CREATE CERTIFICATE OUTPUT</a></li><li><a href="#update-the-template-with-the-correct-arn-and-ip">UPDATE THE TEMPLATE WITH THE CORRECT ARN AND IP</a></li><li><a href="#apply-the-patch-to-the-argocdserver-service">APPLY THE PATCH TO THE ARGOCD-SERVER SERVICE</a></li><li><a href="#create-an-argocd-recordset-in-the-new-zone">CREATE AN ARGOCD RECORDSET IN THE NEW ZONE</a></li><li><a href="#create-the-argocd-loadbalncer">CREATE THE ARGOCD LOADBALNCER</a></li><li><a href="#update-the-argocd-web-ui-password">UPDATE THE ARGOCD WEB UI PASSWORD</a></li><li><a href="#login-to-argo-cd-from-the-command-line">LOGIN TO ARGO CD FROM THE COMMAND LINE</a></li><li><a href="#login-to-argo-cd-from-the-web-ui">LOGIN TO ARGO CD FROM THE WEB UI</a></li><li><a href="#add-users-to-argocd">ADD USERS TO ARGOCD</a></li><li><a href="#generate-a-new-personal-access-token-for-the-user">GENERATE A NEW PERSONAL ACCESS TOKEN FOR THE USER</a></li><li><a href="#add-your-git-access-token-to-argo-cd">ADD YOUR GIT ACCESS TOKEN TO ARGO CD</a></li><li><a href="#building-block-view">BUILDING BLOCK VIEW</a></li></ul></li><li><a href="##-Update-Strategy">UPDATE STRATEGY</a><ul><li><a href="/solution-mq-gitops/Prepare/readme.md#rolling-update-via-script">ROLLING UPDATE VIA SCRIPT</a></li></ul></li></ul></li><li><p><a href="#deployment">DEPLOYMENT</a></p></li><li><p><a href="#security">SECURITY</a></p></li><li><p><a href="#cost">COST</a></p></li><li><p><a href="#risks-and-technical-debts">RISKS AND TECHNICAL DEBTS</a></p></li><li><p><a href="#testing">TESTING</a></p></li><li><p><a href="#architecture-decisions">ARCHITECTURE DECISIONS</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><h1>Tools</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-aws-cli">get the AWS CLI<a href="#get-the-aws-cli" class="hash-link" aria-label="Direct link to get the AWS CLI" title="Direct link to get the AWS CLI">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl &quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot; -o &quot;awscliv2.zip&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unzip awscliv2.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ./aws/install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-kubectl">Get kubectl<a href="#get-kubectl" class="hash-link" aria-label="Direct link to Get kubectl" title="Direct link to Get kubectl">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-argocd-cli">Get the ArgoCD CLI<a href="#get-the-argocd-cli" class="hash-link" aria-label="Direct link to Get the ArgoCD CLI" title="Direct link to Get the ArgoCD CLI">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://github.com/argoproj/argo-cd/releases/download/v2.6.2/argocd-linux-amd64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x  ./argocd-linux-amd64 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mv argocd-linux-amd64  /usr/bin/argocd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>ArgoCD</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-hosted-zone-in-route-53">Create a hosted Zone in Route 53<a href="#create-a-hosted-zone-in-route-53" class="hash-link" aria-label="Direct link to Create a hosted Zone in Route 53" title="Direct link to Create a hosted Zone in Route 53">​</a></h2><p>We are using the domain gitops-mq.demotime.cloud for this demo. You can use any domain you like.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 create-hosted-zone --name gitops-mq.demotime.cloud --caller-reference &quot;Route 53 Addition&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Location&quot;: &quot;https://route53.amazonaws.com/2013-04-01/hostedzone/Z05962992YBU6O501Z5JI&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;HostedZone&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Id&quot;: &quot;/hostedzone/Z05962992YBU6O501Z5JI&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Name&quot;: &quot;gitops-mq.demotime.cloud.&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;CallerReference&quot;: &quot;Route 53 Addition&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Config&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;PrivateZone&quot;: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ResourceRecordSetCount&quot;: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ChangeInfo&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Id&quot;: &quot;/change/C05639501P5X1SLWTV7IX&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Status&quot;: &quot;PENDING&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;SubmittedAt&quot;: &quot;2023-02-21T18:52:35.108000+00:00&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;DelegationSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;NameServers&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ns-141.awsdns-17.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ns-1128.awsdns-13.org&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ns-569.awsdns-07.net&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ns-1793.awsdns-32.co.uk&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-a-certificate-for-the-hosted-zone">Request a Certificate for the hosted zone<a href="#request-a-certificate-for-the-hosted-zone" class="hash-link" aria-label="Direct link to Request a Certificate for the hosted zone" title="Direct link to Request a Certificate for the hosted zone">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws acm request-certificate \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--domain-name gitops-mq.demotime.cloud \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--key-algorithm RSA_2048 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--validation-method DNS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--idempotency-token 1234 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--options CertificateTransparencyLoggingPreference=DISABLED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;CertificateArn&quot;: &quot;arn:aws:acm:us-east-1:748107796891:certificate/1812a0ef-fc55-45bb-944c-48218a263772&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-argocd-into-your-cluster">Install ArgoCD into your cluster<a href="#install-argocd-into-your-cluster" class="hash-link" aria-label="Direct link to Install ArgoCD into your cluster" title="Direct link to Install ArgoCD into your cluster">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace argocd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config set-context --current --namespace=argocd </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-argocd-service-patch-template">Create the ArgoCD service patch template<a href="#create-the-argocd-service-patch-template" class="hash-link" aria-label="Direct link to Create the ArgoCD service patch template" title="Direct link to Create the ArgoCD service patch template">​</a></h2><ul><li>Create this file <code>argocd/argocd-server-patch.yaml</code>, there is a template in the argocd/templates directory</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: &quot;&lt;ACM_ARGOCD_ARN&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type: LoadBalancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  loadBalancerSourceRanges:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - &quot;&lt;LOCAL_IP_RANGES&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-template-with-the-correct-arn-and-ip">Update the template with the correct arn and IP<a href="#update-the-template-with-the-correct-arn-and-ip" class="hash-link" aria-label="Direct link to Update the template with the correct arn and IP" title="Direct link to Update the template with the correct arn and IP">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># NOTE THE ARN IS COPIED FROM THE CREATE CERTIFICATE OUTPUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ACM_ARGOCD_ARN=&quot; arn:aws:acm:us-east-1:748107796891:certificate/ccc1b02c-8bad-4559-ac61-5efd4087432b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -i &quot;s,&lt;ACM_ARGOCD_ARN&gt;,${ACM_ARGOCD_ARN},g; s/&lt;LOCAL_IP_RANGES&gt;/$(curl -s http://checkip.amazonaws.com/)\/32/g; &quot; argocd/argocd-server-patch.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="apply-the-patch-to-the-argocd-server-service">Apply the patch to the argocd-server service<a href="#apply-the-patch-to-the-argocd-server-service" class="hash-link" aria-label="Direct link to Apply the patch to the argocd-server service" title="Direct link to Apply the patch to the argocd-server service">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch svc argocd-server -p &quot;$(cat argocd/argocd-server-patch.yaml)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/argocd-server patched</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-argocd-recordset-in-the-new-zone">Create an ArgoCD Recordset in the new Zone<a href="#create-an-argocd-recordset-in-the-new-zone" class="hash-link" aria-label="Direct link to Create an ArgoCD Recordset in the new Zone" title="Direct link to Create an ArgoCD Recordset in the new Zone">​</a></h2><ul><li>you only need the base subdomain name, it will be pre-appended with &quot;argocd.&quot; </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUBLIC_DNS_NAME=&quot;gitops-mq.demotime.cloud&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">R53_HOSTED_ZONE_ID=&quot;/hostedzone/Z05962992YBU6O501Z5JI&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; argocd-recordset.json &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Changes&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Action&quot;: &quot;CREATE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;ResourceRecordSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    &quot;Name&quot;: &quot;argocd.${PUBLIC_DNS_NAME}.&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    &quot;Type&quot;: &quot;CNAME&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    &quot;TTL&quot;: 300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 &quot;ResourceRecords&quot;: [{ &quot;Value&quot;: &quot;$(kubectl get services argocd-server --output jsonpath=&#x27;{.status.loadBalancer.ingress[0].hostname}&#x27;)&quot;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 change-resource-record-sets --hosted-zone-id $R53_HOSTED_ZONE_ID --change-batch file://argocd-recordset.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ChangeInfo&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Id&quot;: &quot;/change/C06486351JH0L1O3UOPJ8&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Status&quot;: &quot;PENDING&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;SubmittedAt&quot;: &quot;2023-02-21T19:53:29.642000+00:00&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-argocd-load-balncer">Create the ArgoCD Load Balncer<a href="#create-the-argocd-load-balncer" class="hash-link" aria-label="Direct link to Create the ArgoCD Load Balncer" title="Direct link to Create the ArgoCD Load Balncer">​</a></h2><ul><li>Create this file argocd/argocd-deployment-server.patch.yaml</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - argocd-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - --staticassets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - /shared/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          - --insecure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: argocd-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>apply the deployment patch</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch deployment argocd-server -p </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">cat</span><span class="token string variable" style="color:#36acaa"> argocd-deployment-server.patch.yaml</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-the-argocd-web-ui-password">Update the ArgoCD Web UI Password<a href="#update-the-argocd-web-ui-password" class="hash-link" aria-label="Direct link to Update the ArgoCD Web UI Password" title="Direct link to Update the ArgoCD Web UI Password">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUBLIC_DNS_NAME=&quot;gitops-mq.demotime.cloud&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARGOCD_ADDR=&quot;argocd.${PUBLIC_DNS_NAME}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BCRYPT_HASH=$(htpasswd -bnBC 10 &quot;&quot; &lt;PASSWORD&gt; | tr -d &#x27;:\n&#x27; | sed &#x27;s/$2y/$2a/&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl patch secret argocd-initial-admin-secret \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -p &#x27;{&quot;stringData&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;admin.password&quot;: &quot;&#x27;$BCRYPT_HASH&#x27;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;admin.passwordMtime&quot;: &quot;&#x27;$(date +%FT%T%Z)&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="login-to-argo-cd-from-the-command-line">Login to Argo CD from the command line<a href="#login-to-argo-cd-from-the-command-line" class="hash-link" aria-label="Direct link to Login to Argo CD from the command line" title="Direct link to Login to Argo CD from the command line">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">argocd login argocd.gitops-mq.demotime.cloud </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;admin:login&#x27; logged in successfully</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="login-to-argo-cd-from-the-web-ui">Login to Argo CD from the Web UI<a href="#login-to-argo-cd-from-the-web-ui" class="hash-link" aria-label="Direct link to Login to Argo CD from the Web UI" title="Direct link to Login to Argo CD from the Web UI">​</a></h2><ul><li><a href="https://argocd.gitops-mq.demotime.cloud" target="_blank" rel="noopener noreferrer">https://argocd.gitops-mq.demotime.cloud</a>   (use the password you set above)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-users-to-argocd">Add users to ArgoCD<a href="#add-users-to-argocd" class="hash-link" aria-label="Direct link to Add users to ArgoCD" title="Direct link to Add users to ArgoCD">​</a></h2><p>We will add 2 users to the Argo CD Install
Create this file and save it as argocd/argocd-rbac-configmap.yaml</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: argocd-rbac-cm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: argocd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.kubernetes.io/name: argocd-rbac-cm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.kubernetes.io/part-of: argocd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  policy.default: role:readonly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  policy.csv: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, sync, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, update, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, override, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, create, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, get, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, applications, list, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, clusters, create, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, clusters, get, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, clusters, list, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, projects, create, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, projects, get, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, projects, list, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, repositories, create, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, repositories, get, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p, role:ci, repositories, list, *, allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    g, ci, role:ci</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f argocd/argocd-rbac-configmap.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="generate-a-new-personal-access-token-for-the-user">Generate a new personal access token for the user<a href="#generate-a-new-personal-access-token-for-the-user" class="hash-link" aria-label="Direct link to Generate a new personal access token for the user" title="Direct link to Generate a new personal access token for the user">​</a></h2><ul><li><a href="https://github.com/settings/personal-access-tokens/new" target="_blank" rel="noopener noreferrer">https://github.com/settings/personal-access-tokens/new</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-your-git-access-token-to-argo-cd">Add your GIT access token to Argo CD<a href="#add-your-git-access-token-to-argo-cd" class="hash-link" aria-label="Direct link to Add your GIT access token to Argo CD" title="Direct link to Add your GIT access token to Argo CD">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic git-demo \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--from-literal=username=&lt;GIT_USERNAME&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--from-literal=password=&lt;GIT_TOKEN&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="this-section-will-be-for-setting-up-the-project-pipeline-for-the-cicd-pipeline">This section will be for setting up the project pipeline for the CI/CD pipeline<a href="#this-section-will-be-for-setting-up-the-project-pipeline-for-the-cicd-pipeline" class="hash-link" aria-label="Direct link to This section will be for setting up the project pipeline for the CI/CD pipeline" title="Direct link to This section will be for setting up the project pipeline for the CI/CD pipeline">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="update-strategy">Update Strategy<a href="#update-strategy" class="hash-link" aria-label="Direct link to Update Strategy" title="Direct link to Update Strategy">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rolling-update-via-script">Rolling update via script<a href="#rolling-update-via-script" class="hash-link" aria-label="Direct link to Rolling update via script" title="Direct link to Rolling update via script">​</a></h2><p>Because this is a HA deployment, we will need to update the statefulset, and then the pods one at a time</p><p>you can edit this directly, but I prefer to save it to a file and edit it</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl edit statefulset.apps/gitops-mq-demo-ibm-mq -n gitops-mq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>OR</li><li>get the sateful set</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get statefulset gitops-mq-demo-ibm-mq -n gitops-mq --output yaml &gt;mq/statefulset.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>edit the sateful set and apply</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi mq/statefulset.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f mq/statefulset.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>because this statefulset is build around an ondelete update strategy, we will need to manually update the pods</li><li>This script will delete and rebuild the non active instance </li><li>then it will switch active instances and revuild the other instance</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./rolling-upgrade.sh  gitops-mq-demo-ibm-mq  gitops-mq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found the following pods to recycle: gitops-mq-demo-ibm-mq-0,gitops-mq-demo-ibm-mq-1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Determined gitops-mq-demo-ibm-mq-1 is the active instance and will leave </span><span class="token keyword" style="color:#00009f">until</span><span class="token plain"> the end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To </span><span class="token builtin class-name">continue</span><span class="token plain"> </span><span class="token builtin class-name">type</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;accept&#x27;</span><span class="token plain"> below:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accept</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recycling gitops-mq-demo-ibm-mq-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-0&quot;</span><span class="token plain"> deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gitops-mq-demo-ibm-mq-0 deleted, waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> it to become ready</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sleeping </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> seconds to allow pod to resync with native ha pairs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gitops-mq-demo-ibm-mq-0 ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Leaving gitops-mq-demo-ibm-mq-1 pod </span><span class="token keyword" style="color:#00009f">until</span><span class="token plain"> the end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Now recycling gitops-mq-demo-ibm-mq-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-1&quot;</span><span class="token plain"> deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gitops-mq-demo-ibm-mq-1 deleted, waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> it to become ready</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error from server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NotFound</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: pods </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-1&quot;</span><span class="token plain"> not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error from server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NotFound</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: pods </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-1&quot;</span><span class="token plain"> not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error from server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NotFound</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: pods </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-1&quot;</span><span class="token plain"> not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error from server </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NotFound</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: pods </span><span class="token string" style="color:#e3116c">&quot;gitops-mq-demo-ibm-mq-1&quot;</span><span class="token plain"> not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sleeping </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> seconds to allow pod to resync with native ha pairs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gitops-mq-demo-ibm-mq-1 ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recycle complete, the active </span><span class="token keyword" style="color:#00009f">in</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>you can check the pods status by running</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># POD 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe pod/gitops-mq-demo-ibm-mq-0 -n  gitops-mq </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># POD 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe pod/gitops-mq-demo-ibm-mq-1 -n  gitops-mq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ibm-client-engineering/solution-mq-gitops.git/docs/2-Prepare/1-Learn.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solution-mq-gitops/category/prepare"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Prepare</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solution-mq-gitops/Prepare/organize"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Organize</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#get-the-aws-cli" class="table-of-contents__link toc-highlight">get the AWS CLI</a></li><li><a href="#get-kubectl" class="table-of-contents__link toc-highlight">Get kubectl</a></li><li><a href="#get-the-argocd-cli" class="table-of-contents__link toc-highlight">Get the ArgoCD CLI</a></li><li><a href="#create-a-hosted-zone-in-route-53" class="table-of-contents__link toc-highlight">Create a hosted Zone in Route 53</a></li><li><a href="#request-a-certificate-for-the-hosted-zone" class="table-of-contents__link toc-highlight">Request a Certificate for the hosted zone</a></li><li><a href="#install-argocd-into-your-cluster" class="table-of-contents__link toc-highlight">Install ArgoCD into your cluster</a></li><li><a href="#create-the-argocd-service-patch-template" class="table-of-contents__link toc-highlight">Create the ArgoCD service patch template</a></li><li><a href="#update-the-template-with-the-correct-arn-and-ip" class="table-of-contents__link toc-highlight">Update the template with the correct arn and IP</a></li><li><a href="#apply-the-patch-to-the-argocd-server-service" class="table-of-contents__link toc-highlight">Apply the patch to the argocd-server service</a></li><li><a href="#create-an-argocd-recordset-in-the-new-zone" class="table-of-contents__link toc-highlight">Create an ArgoCD Recordset in the new Zone</a></li><li><a href="#create-the-argocd-load-balncer" class="table-of-contents__link toc-highlight">Create the ArgoCD Load Balncer</a></li><li><a href="#update-the-argocd-web-ui-password" class="table-of-contents__link toc-highlight">Update the ArgoCD Web UI Password</a></li><li><a href="#login-to-argo-cd-from-the-command-line" class="table-of-contents__link toc-highlight">Login to Argo CD from the command line</a></li><li><a href="#login-to-argo-cd-from-the-web-ui" class="table-of-contents__link toc-highlight">Login to Argo CD from the Web UI</a></li><li><a href="#add-users-to-argocd" class="table-of-contents__link toc-highlight">Add users to ArgoCD</a></li><li><a href="#generate-a-new-personal-access-token-for-the-user" class="table-of-contents__link toc-highlight">Generate a new personal access token for the user</a></li><li><a href="#add-your-git-access-token-to-argo-cd" class="table-of-contents__link toc-highlight">Add your GIT access token to Argo CD</a></li><li><a href="#this-section-will-be-for-setting-up-the-project-pipeline-for-the-cicd-pipeline" class="table-of-contents__link toc-highlight">This section will be for setting up the project pipeline for the CI/CD pipeline</a></li><li><a href="#update-strategy" class="table-of-contents__link toc-highlight">Update Strategy</a></li><li><a href="#rolling-update-via-script" class="table-of-contents__link toc-highlight">Rolling update via script</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.ibm.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM</a></li><li class="footer__item"><a href="https://www.ibm.com/client-engineering" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBM Client Engineering</a></li></ul></div></div></div></footer></div>
<script src="/solution-mq-gitops/assets/js/runtime~main.285e8d6b.js"></script>
<script src="/solution-mq-gitops/assets/js/main.6d7487b9.js"></script>
</body>
</html>